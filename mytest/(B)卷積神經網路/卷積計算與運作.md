# 卷積計算與運作

## 卷積的基本計算

卷積的計算可以簡單理解為以下步驟：

1. **卷積核（Filter）與輸入圖像的局部區域進行點積**：
   - 卷積核是一個小的矩陣（例如 3×3 或 5×5），它會在輸入圖像上滑動。
   - 在每個位置，卷積核的每個元素與輸入圖像對應位置的像素值相乘，然後將結果相加，得到一個單一的數值。

2. **滑動窗口**：
   - 卷積核會從輸入圖像的左上角開始，逐步向右滑動，然後換行向下，直到覆蓋整個圖像。
   - 每次滑動都會計算一個新的輸出值。

3. **生成輸出特徵圖（Feature Map）**：
   - 每次計算的結果會填入輸出特徵圖中，形成一個新的矩陣。

4. **處理多通道輸入**：
   - 如果輸入圖像有多個通道（例如 RGB 圖像有 3 個通道），卷積核會對每個通道分別進行計算，然後將結果相加，得到最終的輸出值。

5. **偏置（Bias）**：
   - 在每次計算的結果中，通常會加上一個偏置值，作為模型的可學習參數之一。

---

## 卷積核的概念

1. **大小適中**：
   - 小的卷積核（例如 3×3）可以更細緻地捕捉局部特徵，適合提取邊緣、紋理等細節。
   - 大的卷積核（例如 7×7）可以捕捉更大的上下文信息，但可能會忽略細節。

2. **常用大小**：
   - 3×3 是最常用的卷積核大小，因為它在捕捉局部特徵和計算效率之間達到了良好的平衡。

3. **多層堆疊**：
   - 多層 3×3 的卷積核堆疊可以實現與更大卷積核（如 5×5 或 7×7）相同的感受野，但參數量更少。

---

## 卷積核在百萬像素級圖片上的運作

對於一張百萬像素級的圖片（例如 1000×1000 的圖像），卷積核的運作如下：

1. **滑動與計算**：
   - 假設使用 3×3 的卷積核，這意味著每次操作會覆蓋圖片中的 3×3 區域（共 9 個像素）。
   - 卷積核從左上角開始滑動，逐步覆蓋整個圖片。

2. **步幅（Stride）**：
   - 如果步幅設為 1，卷積核每次滑動 1 個像素，特徵圖的大小接近原圖大小。
   - 如果步幅設為 2，特徵圖的大小會縮小一半。

3. **多通道處理**：
   - 對於彩色圖片（如 RGB），卷積核會對每個通道分別計算，然後將結果相加，生成最終的輸出值。

4. **特徵圖生成**：
   - 卷積核滑動整個圖片後，生成一個新的特徵圖。
   - 如果使用多個卷積核（例如 32 個），則會生成 32 個特徵圖，捕捉不同的特徵（如邊緣、紋理等）。

5. **邊界處理**：
   - 如果不進行填充（padding），特徵圖的大小會比原圖小。
   - 使用填充可以保留原圖大小的特徵圖。

6. **多層卷積的效果**：
   - 單層卷積提取局部的低層次特徵，多層卷積堆疊後，特徵逐層被抽象化，捕捉到更高層次的特徵。

---

## 總結

- 卷積核是提取圖像局部特徵的核心工具。
- 小的卷積核（如 3×3）通過多層堆疊可以捕捉到全局特徵。
- 在百萬像素級圖片中，卷積核通過滑動窗口和多層結構有效提取特徵，並降低參數量。
